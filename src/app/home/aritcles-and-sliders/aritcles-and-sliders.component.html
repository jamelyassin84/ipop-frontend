<ng-template #customizeSlider>
    <EditSliderImage></EditSliderImage>
</ng-template>

<ng-template #addArticle>
    <AddArticle></AddArticle>
</ng-template>

<ng-template #addQuickLinks>
    <AddQuickLinks></AddQuickLinks>
</ng-template>

<div
    *ngIf="!isUser"
    class="d-flex"
    style="justify-content: flex-end; position: relative; z-index: 1"
>
    <Modal
        icon="ti-pencil-alt"
        size="lg"
        title="Customize Slider"
        btnSize="sm"
        btnTitle="Customize Slider"
        btnClass="btn bgc-blue-900 text-white mB-10"
        [template]="customizeSlider"
    ></Modal>
</div>

<div
    @zoomIn
    class="row d-flex aic jcc"
    style="min-height: 50vh; background-color: rgba(0, 0, 0, 0.1)"
    *ngIf="images.length === 0"
>
    <Spinner></Spinner>
    <NoDataComponent [data]="images"></NoDataComponent>
</div>

<div style="position: relative; z-index: 0" *ngIf="images.length !== 0">
    <carousel
        [margin]="0"
        [height]="500"
        [dots]="true"
        [autoplay]="images.length < 2 ? false : true"
        [borderRadius]="5"
        [autoplayInterval]="2000"
        [cellsToShow]="innerWidth > 1139 ? (images.length === 1 ? 1 : 2.3) : 1"
    >
        <div
            class="carousel-cell"
            *ngFor="let image of images"
            style="height: 50vh"
        >
            <img class="t-w-full t-h-full t-object-contain" [src]="image" />
        </div>
    </carousel>
</div>

<div class="t-grid t-grid-cols-1 md:t-grid-cols-3 bg-light t-gap-10 mT-40">
    <div [@listAnimation]="articles.length" class="md:t-col-span-2 t-bg-white">
        <ul class="bg-white nav nav-tabs d-flex">
            <li *ngFor="let tab of filterList" class="nav-item">
                <a
                    role="button"
                    (click)="setTab(tab)"
                    class="nav-link"
                    [ngClass]="{
                        't-bg-bg-brand t-text-white ': tabs[tab],
                        'text-muted': !tabs[tab]
                    }"
                >
                    <i class="ti-timer"></i> {{ tab | titlecase }}
                </a>
            </li>

            <li *ngIf="!isUser" class="ml-auto mr-2">
                <DropDown [buttons]="nav"></DropDown>
                <ng-template #nav>
                    <Modal
                        size="lg"
                        title="Add Article"
                        btnSize="sm"
                        btnTitle="Add an article"
                        btnClass="dropdown-item text-secondary"
                        [template]="addArticle"
                    ></Modal>
                </ng-template>
            </li>
        </ul>

        <NoDataComponent [data]="articles"></NoDataComponent>

        <div class="m-0 bl br" *ngFor="let article of articles">
            <div class="bg-white card-header d-flex aic">
                <div>
                    <div class="m-0 h3 card-title dw">{{ article.title }}</div>
                </div>
                <div *ngIf="!isUser && isSuperAdmin" class="ml-auto">
                    <DropDown [buttons]="dropdown"></DropDown>
                    <ng-template #dropdown>
                        <button
                            (click)="removeArticle(article.id)"
                            class="dropdown-item"
                        >
                            Remove Article
                        </button>
                    </ng-template>
                </div>
            </div>
            <div class="bg-white card-header">
                <span class="m-0 c-blue-900"
                    ><i class="ti-alarm-clock"></i> Created :
                    {{
                        article.created_at | date: 'MMMM dd, yyy - hh:mm a'
                    }}</span
                >
            </div>
            <div class="bg-white card-body">
                <div class="d-flex row">
                    <p class="pX-20 col-md-8">
                        {{ article.body }}
                    </p>
                    <div
                        *ngIf="article.photos.length !== 0"
                        class="ml-auto mr-2 col-md-3"
                    >
                        <img
                            class="article-image"
                            [src]="article.photos[0].file.uri"
                            alt=""
                        />

                        <Modal
                            size="xl"
                            [title]="'Images of ' + article.title"
                            btnTitle="View Images"
                            [template]="imageViewer"
                            btnClass="md:hover:t-underline t-text-blue-500 t-text-center t-mt-3 t-w-full"
                            (click)="transformImages(article.photos)"
                        >
                        </Modal>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div @slideInRight class="p-0 m-0 w-100">
        <div class="bg-white card">
            <div class="card-header bgc-blue-900 d-flex h4 aic">
                <div class="mr-auto text-white">Quick links</div>
                <Modal
                    *ngIf="!isUser"
                    icon="ti-plus"
                    size="lg"
                    title="Add Quick Link"
                    btnSize="sm"
                    btnTitle="Add"
                    btnClass="btn bgc-blue-900 ml-auto text-white"
                    [template]="addQuickLinks"
                ></Modal>
            </div>
            <div style="overflow: auto">
                <NoDataComponent [data]="quickLinks"></NoDataComponent>

                <div
                    class="card-body d-flex aic"
                    *ngFor="let link of quickLinks"
                >
                    <span class="p-10">
                        <i
                            class="ti-control-shuffle c-blue-900"
                            style="font-size: 2rem"
                        ></i>
                    </span>
                    <a
                        role="button"
                        [href]="link.url"
                        target="_blank"
                        class="p-10"
                    >
                        {{ link.title }}
                    </a>
                    <span *ngIf="!isUser && isSuperAdmin" class="ml-auto">
                        <button
                            placement="right "
                            ngbTooltip="Remove"
                            (click)="removeLink(link.id)"
                            class="btn btn-sm text-secondary"
                        >
                            <i class="ti-minus"></i>
                        </button>
                    </span>
                </div>
            </div>
        </div>
    </div>
</div>

<ng-template #imageViewer>
    <ImageViewer [images]="currentImages"></ImageViewer>
</ng-template>
